{"cells":[{"kind":1,"language":"markdown","value":"## Create Cloud builder\n\nTo use hydrobuild, start by checking whether you need to configure your access to a builder.\n\nUse this command to see whether you already have a cloud builder configured."},{"kind":2,"language":"shellscript","value":"docker buildx ls"},{"kind":1,"language":"markdown","value":"The next two lines are required if you don't have a builder configured.  The first invocation will\ncreate a new builder with a single `linux/amd64` node.  The `docker/labs_linux-amd64` references\nyour hydrobuild instance which must currently be provisioned for you in the [admin ui](https://docker.com).\n\nThe second command adds a `linux/amd64` node so that you can do multi-platform builds with this builder."},{"kind":2,"language":"shellscript","value":"docker buildx create --driver cloud --name hydrobuild --platform linux/amd64 docker/labs_linux-amd64"},{"kind":2,"language":"shellscript","value":"docker buildx create --driver cloud --name hydrobuild --platform linux/arm64 docker/labs_linux-arm64 --append"},{"kind":1,"language":"markdown","value":"## Run a multi-platform HydroBuild\n\nBuild on `linux/amd64` and `linux/arm64` hosts using the following command line.  This build is configured to push to a registry\n(`vonwig/nodejs-service`) when complete."},{"kind":2,"language":"shellscript","value":"docker buildx build --builder hydrobuild --platform linux/amd64,linux/arm64 --tag vonwig/nodejs-service:latest --file Dockerfile --push ."}]}